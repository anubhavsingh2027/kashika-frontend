<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create Account â€” Kashika Travels</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
  </head>
  <body
    class="antialiased bg-gradient-to-b from-slate-50 to-white text-slate-800"
  >
    <nav id="navbar" class="sticky top-0 z-40"></nav>

    <main class="min-h-screen flex items-center justify-center p-6">
      <form
        id="registerForm"
        class="max-w-lg w-full bg-white rounded-2xl shadow-lg p-8 space-y-4"
      >
        <div class="flex items-center gap-3">
          <img
            src="./assets/images/logo.png"
            class="h-10 w-10 rounded-full shadow-sm"
            alt="logo"
          />
          <h2 class="text-2xl font-semibold">Create Your Account</h2>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <input
            id="userName"
            placeholder="Full name"
            class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-sky-400 outline-none"
            required
          />
          <input
            id="email"
            placeholder="Email address"
            type="email"
            class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-sky-400 outline-none"
            required
          />
          <input
            id="phone"
            placeholder="Phone number"
            class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-sky-400 outline-none"
            required
          />
          <input
            id="location"
            placeholder="City / Location"
            class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-sky-400 outline-none"
          />
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <input
            id="password"
            type="password"
            placeholder="Password"
            class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-sky-400 outline-none"
            required
          />
          <input
            id="confirmPassword"
            type="password"
            placeholder="Confirm Password"
            class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-sky-400 outline-none"
            required
          />
        </div>

        <button
          id="registerBtn"
          type="submit"
          class="w-full py-3 bg-gradient-to-r from-sky-600 to-indigo-600 text-white rounded-lg font-semibold"
        >
          Create Account
        </button>
        <p id="registerMessage" class="text-center text-sm font-medium"></p>
      </form>
    </main>

    <script type="module" src="./assets/js/DynamicNav.js"></script>
    <script type="module" src="./assets/js/tailwind-init.js"></script>
    <script type="module">
      import { registerUser } from "./assets/js/services.js";
      import { showToast, withLoader } from "./assets/js/tailwind-init.js";

      const form = document.getElementById("registerForm");
      const msg = document.getElementById("registerMessage");
      const btn = document.getElementById("registerBtn");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        msg.textContent = "";
        msg.style.color = "";

        const userName = document.getElementById("userName").value.trim();
        const email = document.getElementById("email").value.trim();
        const phone = document.getElementById("phone").value.trim();
        const location = document.getElementById("location").value.trim();
        const password = document.getElementById("password").value;
        const confirmPassword =
          document.getElementById("confirmPassword").value;
        if (password !== confirmPassword) {
          showToast("Passwords do not match", "error");
          msg.textContent = "Passwords do not match";
          msg.style.color = "red";
          return;
        }

        const userData = { userName, email, phone, location, password };

        await withLoader(btn, async () => {
          const result = await registerUser(userData);
          if (result.error) {
            showToast(result.message || "Registration failed", "error");
            msg.textContent = result.message || "Registration failed";
            msg.style.color = "red";
          } else if (result.status) {
            showToast(result.message || "Account created", "success");
            msg.textContent = result.message || "Account created";
            msg.style.color = "green";
            form.reset();
            setTimeout(() => {
              window.location.href = "index.html";
            }, 1500);
          } else {
            showToast("Unexpected server response", "error");
            msg.textContent = "Unexpected server response";
            msg.style.color = "red";
          }
        });
      });
    </script>
  </body>
</html>
